Network

------

## 💡 一、计算机网络概述（总览）

message-segment-datagram-frame

计算：checksum/CRC/Tcp congestion control/time/OSPF

### 1. 网络的基本概念

### Network Edge



### Network Core

packet switching（Internet）

- 存储转发
- 排队时延
- 丢包/拥塞控制
- 转发表
- 路由选择

circult switching（电话）

- 持续独占资源 
- end to end connection
- FDM Frequency-Division Multiplexing 无线电台 频段带宽 4kHz
- TDM 一帧包含多个时隙 传输速率=帧速率*bit 64kbps
- 三层ISP 向上层ISP付费
- 接入1SP、区域ISP、第一层ISP、POP、多宿、对等和IXP（对等无结算）

```
节点处理时延(nodal processing delay)  差错检验
排队时延( queuing delay) 等待前序队列 流量强度La/R
传输时延(transmission delay ) 
	L（分组长度）/R（传输速率）
传播时延(propagation delay) 
	d（路由器距离）/s（媒介速率）
d'nodal=d'proc+d'queue+d'trans+d'prop
d'end-end=N(d'proc+d'trans+d'prop)
RTT ≈ 2 × (传播时延 + 传输时延) + 处理时延 + 排队时延
```

吞吐量 瓶颈链路

### 4. 计算机网络的体系结构

- 分层思想、封装与解封装过程

>  网络设计者以分层 ( layer)的方式组织协议并实现这些协议的网络硬件和软件。每个协议属于这些层次之一，就像图1-2 所示的航线体系结构中的每种功能属于某一层一样。我们再次关注某层向它的上一层提供的服务(service)，即所谓一层 的服务模型 (service model)。
>
>  每层通过在该层中执行某些操作或使用直接下层的服务来提供服务。 例如，由第n层提供 的服务可能包括报文从网络的一 边到另一边的可靠交付。这可能是通过使用第n- 1层的边缘到边缘的不可靠报文传送服 务，加上第n层的检测和重传丢失报文的功能来实现的。
> 一个协议层能够用软件、硬件或两者的结合来实现。诸如HTTP 和SMTP 这样 的应用层协议几乎, 总是在端系统中用软件实现，运输层协议也是如此。因为物理层和数据链路层 负责处理跨越特定链路的通信，它们通常在与给定链路相关联的网络接口卡 (例如以太网或wifi接口卡 ) 中 实 现 。 网 络 层 经 常 是 硬 件 和 软 件 实 现 的 混 合 体 。 还 要 注 意 的 是，一 个 第 n层协议也分布在构成该网络的端系统、分组交换机和其他组件中。这就是说，第n层协 议 的 不 同 部 分 常 常位于这些网络组件的各部分中。

- 

------

## 🌐 二、应用层（最顶层）

报文 message 接口socket

服务要求: 可靠数据传输（防丢失）、吞吐量（交付速率保证）、定时（时延）和安全性（加密 完整性）

Eg.多媒体应用：容忍丢失但带宽敏感

TCP 服务模型包括面向连接服务（握手、拆除连接）和可靠数据传输服务（无错有序）

### HTTP

- 使用TCP

- 无状态 stateless

- persistent （:bulb:题目,时延计算）

- GET 请求对象 参数在url中

- POST 提交表单 参数在协议实体（entity body）

  ```
  200 OK | 301 Moved Permanently
  400 Bad Request| 404 NotFound
  ```

- cookie 保存在用户浏览器 唯一编码维护历史数据
- web cache（proxy server）http == web cache == server，减少响应时间，减少ISP到因特网通信量，命中率 条件GET
- HTTP2（成帧排序）HTTP3

### 1. 网络应用模型

- 客户端/服务器（C/S）模型：Web\Telnet \Email
- 对等（P2P）模型：Napster、BitTorrent

### 2. 域名系统 DNS

- 层次结构（根、顶级域、子域）
- 域名解析过程（迭代 vs 递归）
- 缓存两天
- DNS 报文结构

### 3. 万维网与 HTTP 协议

- HTTP 报文格式、GET 与 POST 区别
- 无状态连接、持久连接、状态码（如 200、404、301）
- Cookie 与 Session 基本概念

### 4. 文件传输协议 FTP

- 控制连接（21端口）+ 数据连接（20端口）
- 主动模式 vs 被动模式

### 5. 电子邮件协议

- SMTP：发送邮件 /tcp
- POP3 / IMAP：接收邮件
- MIME：支持附件、格式文本

------

## 📦 三、传输层

### 报文段 segment   process to process

### 1. 传输层服务与端口

- 传输层功能：进程间通信、可靠性、差错控制
- 端口号（常见：HTTP 80, FTP 21, DNS 53）

### 2. UDP 协议（无连接）

- 数据报结构、校验和机制
- 无连接 无可靠性 无流量控制 无拥塞控制
- 应用场景：DNS、视频通话、VoIP

### 3. TCP 协议（面向连接）

- 报文段结构（序列号、确认号、窗口等）
- 三次握手与四次挥手
- 可靠传输机制：确认 + 超时重传、滑动窗口（ARQ）
- 流量控制：滑动窗口协议
- 拥塞控制：慢开始、拥塞避免、快重传、快恢复

checksum计算：二进制加法、最高位进位回卷、结果取反码

------

## 🛰️ 四、网络层

数据报 datagram 主机到主机

### 1. 网络层功能

为传输层提供：确保交付：一定时延：有序：一定带宽：安全

尽力而为 best-effort

- 数据平面 硬件：forwording：路由器将分组从输入链路接口转移到输出链路接口：根据首部字段查表选择输出接口
- 控制平面 软件：传统/SDN：routing：处理分组从源到目的地路径

### router

转发：前缀匹配 longest prefix matching  rule

分组调度：FIFO/priority：non-preemptive/round robin queuing/weighted fair queuing



### 2. IP 协议（IPv4）

- 报文结构、字段意义（TTL、协议号、首部校验和等）

- 20Bytes 头部；Payload

- IP 分片、重组；最大传输单元（MTU）

- IP 数据报（简略结构）：

  | 版本 | 首部长度IHL | 服务类型TOS | 总长度           |
  | 标识 | Flags | 片偏移             |
  | TTL  | 协议6TCP17UDP | 头部校验和         |
  | 源 IP 地址                    |
  | 目的 IP 地址                 |
  | （可选字段）                  |
  | 数据部分（TCP/UDP/ICMP等）     |

### 3. IP 地址

- 地址分类 A/B/C/D/E，CIDR、子网划分、子网掩码计算
- 私有地址与 NAT（网络地址转换）

DHCP：plug and play

- discover：广播
- offer：广播，包含推荐ip及时长
- request：定向选择服务器
- ack

NAT：WAN--LAN，端口转发

泛化转发：筛选条目不局限于ip，openflow 流表 flowtable

IPV6：128bits length address；40Bytes Header

- 不允许在中间路由分片重组
- 无checksum
- 无option 因此定长



routing algorithm：

- Link State（LS）：全知：OSPF：Dijkstra
- decentralized：DV：迭代异步：BellmanFord：好消息传得快坏消息传得慢（count-to-infinity）
- 或
- static
- dynamic

intra-autonomous system routing protocol

- OSPF

inter - autonomous system routing protocol

- BGP



ICMP：

- type--code--state
- Traceroute--TTL

### 5. 路由算法与协议

- 距离向量算法（RIP）、链路状态算法（OSPF）
- 层次路由、默认路由
- 域间路由协议：BGP
- 组播与移动 IP 简要了解

### 6. 网络层设备

- 路由器组成与工作原理
- 路由表结构、数据包的转发过程

------

## 🔗 五、数据链路层

帧 frame 节点node 链路link 交换机

服务：

- framing：encapsulate datagram into frame
- link access：介质访问控制（MAC协议）
- 可靠交付：确认重传
- EDC：error detection and correction

### 2. 成帧方式

- 字符计数法、字符填充法、比特填充法

### 3. EDC

- Parity checking 二维 前向纠错FEC
- Checksum，加法求反码全1，见TCP
- CRC：:bulb: D*2'r /G ，全程模2

### 4. MAC

- channel partition：FDM、TDM、CDMA码分多址

- random access：

- - slotted ALOHA 概率重传

  - CSMA 载波侦听

  - CSMA/CD 察觉碰撞立即停止

    binary exponential backoff  K=random[0，2'n-1]

  - CSMA/CA（无线）

- take turns：

- - polling
  - token-passing 

### 5. LANs

- MAC address 6Bytes XX-XX-XX-XX-XX-XX 与硬件接口绑定
- ARP  地址解析 IP》MAC  广播查询 维护ARP table 路由器转发 :bulb:

- 以太网与 IEEE 802.3：帧结构、MAC 地址、最小最大帧长
- IEEE 802.11（Wi-Fi）相关机制

### 交换机

- plug and play
- 自学习 老化期

switch and router

第三层：配置路由表：使用IP地址：有防火墙：可能循环

第二层：即插即用：使用MAC：可能崩溃：走拓扑不循环

VLAN

MPLS label-switched router MPLS使能网络



### 6. 广域网协议

- PPP、HDLC 基本原理与帧格式

### 7. 数据链路层设备

- 网桥、交换机
- 冲突域与广播域
- 交换机的帧转发过程、转发表构建（学习算法）

------

## 📡 六、物理层（最底层）

### 1. 通信基础

- 信道、信号、带宽、码元、波特率、传输速率
- 奈奎斯特定理与香农定理
- 模拟信号与数字信号、调制与编码

### 2. 传输方式

- 电路交换、报文交换、分组交换（对比其延迟、适用场景）

### 3. 传输介质

- 有线介质：双绞线、同轴电缆、光纤
- 无线介质：微波、红外、卫星通信
- 各自特点与数据速率

### 4. 物理层设备

- 中继器：信号放大、整形
- 集线器（Hub）：冲突域扩展，不隔离广播
- 与交换机的区别

------

- 上网全过程

  主机向DHCP服务器请求IP：

  - 生成包含请求的UDP报文：端口号
  - 封装入IP数据报：广播IP
  - 封装入以太网帧：广播MAC
  - 经交换机广播到DHCP服务器
  - 逐层解封装读取请求
  - 分配IP，封装ACK报文，已知MAC
  - 交换机转发到特定端口
  - 主机接收ACK，抽取，初始化IP、网关、DNS服务器

  DNS

  - 生成DNS query，需要网关MAC
  - ARP，广播查询默认网关对应MAC
  - DNS query
  - 路由器转发 域内RIP/OSPF，域间BGP
  - DNS服务器查找数据库，DNS answer
  - 主机获得ip

  C/S数据流交互

  - TCP socket 三次握手 SYN-SYNACK
  - HTTP GET
  - HTTP answer





# Network

summary

end to end （host）

point to point

port to port

---



## :bulb:application

#### DNS

#### HTTP*

协议 请求与返回时间 解读报文

#### FTP

#### SMTP

---



## :bulb:transport

进程到进程 port

#### TCP 

流量控制和拥塞控制

可靠传输

#### UDP

---



## :bulb:network

距离矢量 链路状态

### IPv4

子网划分与子网掩码

#### ARP

#### DHCP

#### ICMP

#### NAT

### Routing

#### RIP

#### OSPF

#### BGP

---



## :bulb:data link

点到点

### control

crc

#### ALOHA

#### CSMA

#### CSMA/CA

#### CSMA/CD*

二进制指数退避

### Ethernet

#### IEEE802.3

#### IEEE 802.11

#### PPP HDLC

#### *MAC Address*

---



## phisical
